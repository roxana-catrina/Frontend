<div class="update-user-container">
  <!-- Header -->
  <div class="page-header">
    <button class="btn btn-outline-secondary back-btn" (click)="goToDashboard()">
      <i class="bi bi-arrow-left"></i> Înapoi
    </button>
    <h2 class="page-title">
      <i class="bi bi-person-circle"></i> Actualizare Profil
    </h2>
  </div>

  <!-- Form Card -->
  <div class="form-card shadow-lg">
    <div class="card-header">
      <h4 class="mb-0">
        <i class="bi bi-pencil-square"></i> Editare Informații Personale
      </h4>
    </div>

    <div class="card-body">
      <form [formGroup]="updateUserForm">
        <div class="row">
          <!-- Informații Personale -->
          <div class="col-12">
            <h6 class="section-title">
              <i class="bi bi-person-badge"></i> Informații de Identificare
            </h6>
          </div>

          <div class="col-md-6 mb-3">
            <label for="nume" class="form-label">
              <i class="bi bi-person"></i> Nume <span class="text-danger">*</span>
            </label>
            <input type="text" 
                   id="nume" 
                   class="form-control" 
                   formControlName="nume" 
                   placeholder="Introduceți numele"
                   required>
            <div *ngIf="updateUserForm.controls['nume'].invalid && updateUserForm.controls['nume'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small *ngIf="updateUserForm.controls['nume'].errors?.['required']">
                Numele este obligatoriu.
              </small>
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="prenume" class="form-label">
              <i class="bi bi-person"></i> Prenume <span class="text-danger">*</span>
            </label>
            <input type="text" 
                   id="prenume" 
                   class="form-control" 
                   formControlName="prenume"
                   placeholder="Introduceți prenumele" 
                   required>
            <div *ngIf="updateUserForm.controls['prenume'].invalid && updateUserForm.controls['prenume'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small *ngIf="updateUserForm.controls['prenume'].errors?.['required']">
                Prenumele este obligatoriu.
              </small>
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="data_nasterii" class="form-label">
              <i class="bi bi-calendar-event"></i> Data Nașterii <span class="text-danger">*</span>
            </label>
            <input type="date" 
                   id="data_nasterii" 
                   class="form-control" 
                   formControlName="data_nasterii" 
                   required>
            <div *ngIf="updateUserForm.controls['data_nasterii'].invalid && updateUserForm.controls['data_nasterii'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small *ngIf="updateUserForm.controls['data_nasterii'].errors?.['required']">
                Data nașterii este obligatorie.
              </small>
              <small *ngIf="updateUserForm.controls['data_nasterii'].errors?.['futureDate']">
                Data nașterii nu poate fi în viitor.
              </small>
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="sex" class="form-label">
              <i class="bi bi-gender-ambiguous"></i> Sex <span class="text-danger">*</span>
            </label>
            <select id="sex" class="form-select" formControlName="sex" required>
              <option [value]="null" disabled selected>Selectați sexul</option>
              <option value="Masculin">Masculin</option>
              <option value="Feminin">Feminin</option>
              <option value="Altele">Altele</option>
            </select>
            <div *ngIf="updateUserForm.controls['sex'].invalid && updateUserForm.controls['sex'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small>Sexul este obligatoriu.</small>
            </div>
          </div>

          <!-- Separator -->
          <div class="col-12 my-3">
            <hr class="divider">
          </div>

          <!-- Informații de Contact -->
          <div class="col-12">
            <h6 class="section-title">
              <i class="bi bi-telephone"></i> Informații de Contact
            </h6>
          </div>

          <div class="col-md-6 mb-3">
            <label for="email" class="form-label">
              <i class="bi bi-envelope"></i> Email <span class="text-danger">*</span>
            </label>
            <input type="email" 
                   id="email" 
                   class="form-control" 
                   formControlName="email"
                   placeholder="exemplu@email.com" 
                   required>
            <div *ngIf="updateUserForm.controls['email'].invalid && updateUserForm.controls['email'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small *ngIf="updateUserForm.controls['email'].errors?.['required']">
                Email-ul este obligatoriu.
              </small>
              <small *ngIf="updateUserForm.controls['email'].errors?.['email']">
                Format email invalid.
              </small>
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="numar_telefon" class="form-label">
              <i class="bi bi-phone"></i> Telefon <span class="text-danger">*</span>
            </label>
            <div class="input-group">
              <span class="input-group-text prefix-badge">{{ prefix }}</span>
              <input type="text" 
                     id="numar_telefon" 
                     class="form-control" 
                     formControlName="numar_telefon"
                     placeholder="700000000" 
                     required 
                     (change)="onPrefixChange($event)">
            </div>
            <div *ngIf="updateUserForm.controls['numar_telefon'].invalid && updateUserForm.controls['numar_telefon'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small>Numărul de telefon trebuie să conțină doar cifre și să aibă între 8-15 caractere!</small>
            </div>
          </div>

          <div class="col-md-6 mb-3">
            <label for="tara" class="form-label">
              <i class="bi bi-globe"></i> Țară <span class="text-danger">*</span>
            </label>
            <select id="tara" class="form-select" formControlName="tara" (change)="onPrefixChange($event)">
              <option [value]="null" disabled selected>Selectați țara</option>
              <option *ngFor="let country of countriesList" [value]="country.nume">
                {{ country.nume }}
              </option>
            </select>
            <div *ngIf="updateUserForm.controls['tara'].invalid && updateUserForm.controls['tara'].touched" 
                 class="error-message">
              <i class="bi bi-exclamation-circle"></i>
              <small>Țara este obligatorie.</small>
            </div>
          </div>
        </div>

        <!-- Buttons -->
        <div class="form-actions">
          <button type="button" class="btn btn-secondary" (click)="goToDashboard()">
            <i class="bi bi-x-circle"></i> Anulează
          </button>
          <button type="submit" 
                  class="btn btn-primary" 
                  (click)="updateUser()" 
                  [disabled]="updateUserForm.invalid">
            <i class="bi bi-check-circle"></i> Salvează Modificările
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
